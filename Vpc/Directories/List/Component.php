<?phpabstract class Vpc_Directories_List_Component extends Vpc_Abstract_Composite_Component{    private $_itemDirectory = false;    public static function getSettings()    {        $ret = parent::getSettings();        $ret['generators']['child']['component']['view'] = 'Vpc_Directories_List_View_Component';        $ret['order'] = false;        $ret['searchQueryFields'] = '*';        return $ret;    }    final public function getItemDirectory()    {        if ($this->_itemDirectory === false) {            $this->_itemDirectory = $this->_getItemDirectory();            if (!is_subclass_of($this->_itemDirectory->componentClass, 'Vpc_Directories_Item_Directory_Component')) {                throw new Vps_Exception("_getItemDirectory must return an Vpc_Directories_Item_Directory_Component, '{$this->_itemDirectory->componentClass}' given");            }        }        return $this->_itemDirectory;    }    abstract protected function _getItemDirectory();    public function getSelect()    {        if (!$this->getItemDirectory()) return null;        $ret = $this->getItemDirectory()->getGenerator('detail')            ->select($this->getItemDirectory());        if ($this->_getSetting('order') !== false) {            $ret->order($this->_getSetting('order'));        }        $searchForm = $this->_getSearchForm();        if ($searchForm) {            $formRow = $searchForm->getComponent()->getFormRow();            $selectInfo = $ret->info();            foreach ($formRow->toArray() as $column => $value) {                if (empty($formRow->$column) || !in_array($column, $selectInfo['cols'])) continue;                $searchWords = preg_split('/[\s-+,;]/', $formRow->$column);                foreach ($searchWords as $searchWord) {                    $searchWord = trim($searchWord);                    if (empty($searchWord)) continue;                    if ($column == 'query') {                        $queryFields = $this->_getSetting('searchQueryFields');                        if ($queryFields) {                            if (!is_array($queryFields)) $queryFields = array($queryFields);                            if (in_array('*', $queryFields)) {                                $queryFields = $selectInfo['cols'];                            }                            $wheres = array();                            foreach ($queryFields as $field) {                                $wheres[] = Vps_Registry::get('db')->quoteInto(                                    $selectInfo['name'].'.'.$field.' LIKE ?', "%$searchWord%"                                );                            }                            $ret->where(implode(' OR ', $wheres));                        }                    } else {                        $ret->where($column.' LIKE ?', "%".$searchWord."%");                    }                }            }        }        return $ret;    }    protected function _getSearchForm()    {        return null;    }}